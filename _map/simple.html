<html>
    <head>
        <title>Testing map animations</title>

        <script src='../_shared/js/vendor/jquery.min.js'></script>

        <script>
            var data = {
                my: {name: 'Poof~', x: 77, y: 58},
                scale: 32,

                characters: [
                    {name: 'Fiolina', x: 74, y: 62},
                    {name: 'Dowlie', x: 74, y: 63},
                    {name: 'SourSadnessBear', x: 75, y: 62},
                    {name: 'Goddess Etro', x: 76, y: 62},
                ]
            };

            function populate(background, foreground, data)
            {
                $(background).prepend("<div class='character me' data-x='"+data.my.x+"' data-y='"+data.my.y+"'>"+data.my.name+"</div>");

                for(var i = 0, l = data.characters.length; i < l; i++)
                {
                    var character = data.characters[i];
                    $(foreground).prepend("<div class='character' data-x='"+character.x+"' data-y='"+character.y+"'>"+character.name+"</div>");
                }
            }

            function position(foreground, data)
            {
                var center = {
                    top: $(foreground).height() / 2,
                    left: $(foreground).width() / 2
                };
                
                $(foreground).find('.character').each(function()
                {
                    var character = this.dataset;
                    var distance = {
                        x: data.my.x - character.x,
                        y: data.my.y - character.y
                    };

                    distance.left = distance.x * data.scale;
                    distance.top = distance.y * data.scale;

                    $(this).css({top: center.top + distance.top, left: center.left - distance.left});
                });
            }
            
            function center(parent, element)
            {
                $(element).css({
                    top: $(parent).height() / 2 - $(element).outerHeight(true) / 2,
                    left: $(parent).width() / 2 - $(element).outerWidth(true) / 2
                });
            }
            
            $(document).ready(function()
            {
                populate('.background', '.foreground', data);
                position('.foreground', data);
                center('.background', '.me');
            });
        </script>

        <style>
            .background, .foreground { position: relative; width: 100%; height: 100%; }
            .character { position: absolute; z-index: 1; height: 10px; width: 10px; font-size: 0pt; border: 1px solid #000; background-color: rgba(0, 0, 0, 0.1); border-radius: 4px; padding: 4px; }
            .character:hover { z-index: 10; height: auto; width: auto; font-size: 12pt; background-color: rgba(255, 255, 255, 0.8); }
        </style>
    </head>

    <body>
        <div class="background">            
            <div class="foreground"></div>
        </div>
    </body>
</html>
